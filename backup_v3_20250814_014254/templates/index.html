{% extends "base.html" %}
{% block title %}CatÃ¡logo Â· PokeShop{% endblock %}
{% block content %}
<h1>CatÃ¡logo</h1>
<form class="filters" action="{{ url_for('index') }}">
  <input type="hidden" name="q" value="{{ q }}">
  <select name="tipo">
    <option value="">Tipo (todos)</option>
    {% for t in ['fuego','agua','elÃ©ctrico','planta','hielo','roca','dragÃ³n'] %}
      <option value="{{t}}" {% if tipo==t %}selected{% endif %}>{{t|capitalize}}</option>
    {% endfor %}
  </select>
  <select name="sort">
    <option value="new" {% if sort=='new' %}selected{% endif %}>Novedades</option>
    <option value="price_asc" {% if sort=='price_asc' %}selected{% endif %}>Precio â†‘</option>
    <option value="price_desc" {% if sort=='price_desc' %}selected{% endif %}>Precio â†“</option>
  </select>
  <button>Aplicar</button>
</form>
<div class="grid">
  {% for p in products %}
  <a class="card" href="{{ url_for('product_detail', pid=p.id) }}">
    <img src="{{ p.image_url or url_for('static', filename='noimg.png') }}" alt="{{ p.nombre }}">
    <div class="title">{{ p.nombre }}</div>
    <div class="muted">Tipo: {{ p.tipo|capitalize }}</div>
    <div class="price">$ {{ "%.2f"|format(p.precio_base) }}</div>
    <div class="muted">Stock: {{ p.stock }}</div>
  </a>
  {% else %}
  <p>No hay productos.</p>
  {% endfor %}
</div>

{% if pag and pag.pages>1 %}
<nav class="row" style="margin-top:10px">
  <div>PÃ¡gina {{ pag.page }} de {{ pag.pages }}</div>
  <div>
    {% if pag.has_prev %}
      <a class="btn" href="{{ url_for('index', q=q, tipo=tipo, sort=sort, page=pag.prev_num) }}">â† Anterior</a>
    {% endif %}
    {% if pag.has_next %}
      <a class="btn" href="{{ url_for('index', q=q, tipo=tipo, sort=sort, page=pag.next_num) }}">Siguiente â†’</a>
    {% endif %}
  </div>
</nav>
{% endif %}
{% endblock %}
